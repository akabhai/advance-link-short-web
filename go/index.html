<!DOCTYPE html>
<html lang="en">
<head><meta charset="UTF-8"><title>Verifying...</title></head>
<body style="background:#0f172a;color:white;display:flex;align-items:center;justify-content:center;height:100vh;">
    <div id="msg">Verifying Security Integrity...</div>
    <script>
        const SALT = "SECURE_GATE_99"; 
        const BLOGGER_1 = "https://yourblog1.blogspot.com/"; // UPDATE THIS

        async function hash(str) {
            const msgUint8 = new TextEncoder().encode(str + SALT);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgUint8);
            return Array.from(new Uint8Array(hashBuffer)).map(b => b.toString(16).padStart(2, '0')).join('');
        }

        async function verify() {
            const params = new URLSearchParams(window.location.search);
            const u = params.get('u'); // Encoded URL
            const h = params.get('h'); // Original Hash

            if(!u || !h) {
                document.getElementById('msg').innerText = "Invalid Link Structure.";
                return;
            }

            // Verify authenticity of the link
            const check = await hash(u);
            if(h === check) {
                // Generate a one-time Step-1 signature based on the hash
                const s1 = await hash(h + "STEP1");
                window.location.href = `${BLOGGER_1}?u=${encodeURIComponent(u)}&h=${h}&s1=${s1}`;
            } else {
                document.getElementById('msg').innerText = "Security Hash Mismatch.";
            }
        }
        verify();
    </script>
</body>
</html>
